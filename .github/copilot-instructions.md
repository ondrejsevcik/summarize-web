# Summarize Web Browser Extension

Summarize Web is a browser web extension (Chrome/Firefox) that allows users to quickly summarize web content using AI services like Venice.ai, ChatGPT, Claude, and Mistral. The extension provides right-click context menus and content scripts for different platforms.

Always reference these instructions first and fallback to search or bash commands only when you encounter unexpected information that does not match the info here.

## Working Effectively

### Prerequisites and Setup
- **Node.js Version**: Project requires Node.js >=22.14.0, but builds successfully with Node.js 20.19.4+ (expect version warnings during npm install)
- Check current versions: `node --version && npm --version`

### Bootstrap and Build the Repository
- `npm install` -- installs dependencies in ~2-10 seconds. Expect Node version warnings but installation succeeds.
- `npm run build` -- builds the extension in ~30 seconds. NEVER CANCEL. Set timeout to 60+ minutes for safety.
- `npm run dev` -- starts development mode with file watching. NEVER CANCEL. Runs continuously until stopped.

### Linting and Formatting
- `npx biome check src/` -- checks source files for linting/formatting issues in ~1-8 seconds. Source files are usually clean.
- `npx biome check --write src/` -- fixes any linting/formatting issues automatically
- **AVOID** running biome on `dist/` folder (build output) as it contains many autogenerated files with issues
- Always run `npx biome check --write src/` before committing changes

## Manual Validation and Testing

### Build Validation
- Always run `npm run build` after making code changes to ensure the extension builds successfully
- Check that `dist/` folder contains all required files: background.js, content scripts, manifest.json, and icons
- Extension build creates separate bundles for each content script (venice, claude, chatgpt, mistral, pageContent, youtube)
- **Quick validation**: `ls dist/` should show 8 JS files + manifest.json + icons directory
- **Manifest validation**: `cat dist/manifest.json | python3 -m json.tool > /dev/null` to verify valid JSON

### Extension Functionality Validation  
**IMPORTANT**: This is a browser web extension that requires a browser environment for full testing.

**In Sandboxed Environments**:
- You CAN validate build processes, code structure, and file generation
- You CANNOT test actual extension functionality (context menus, content injection) without browser access
- You CANNOT load the extension into Chrome/Firefox for end-to-end testing

**Manual Validation Steps When Browser Available**:
1. Load unpacked extension from `dist/` folder in Chrome Developer Mode
2. Test right-click context menu appears with "Summarize in [AI Service]" options  
3. Visit a test webpage and verify context menu functionality
4. Test on supported platforms (Venice.ai, ChatGPT, Claude, Mistral)
5. Verify YouTube content summarization works differently from regular web pages

### No Test Framework
- This project does NOT have automated tests (no Jest, Vitest, or other test frameworks)
- Manual testing in browser environment is the primary validation method
- Focus on build validation and code structure verification in sandboxed environments

## Project Structure and Key Files

### Repository Layout
```
.github/          # GitHub configuration and workflows
src/              # Source code
├── manifest.json     # Extension manifest (Manifest v3)
├── background.ts     # Background script with context menus
├── contentScript_*.ts # Content scripts for different platforms
├── utils.ts          # Utility functions and helpers
├── types.ts          # TypeScript type definitions  
├── prompt.ts         # AI prompt template
├── dom-utils.ts      # DOM manipulation utilities
└── public/icons/     # Extension icons
dist/             # Build output (generated by npm run build)
package.json      # Dependencies and npm scripts
vite.config.ts    # Vite build configuration
tsconfig.json     # TypeScript configuration
```

### Key Source Files
- **manifest.json**: Extension manifest with permissions and content script definitions
- **background.ts**: Handles browser context menu creation and message passing
- **contentScript_[platform].ts**: Inject functionality into specific AI platforms
- **contentScript_pageContent.ts**: General web page content extraction
- **contentScript_youtube.ts**: YouTube-specific content handling
- **utils.ts**: Common utilities like DOM querying, tab management, timing functions
- **types.ts**: Zod schemas and TypeScript types for message passing
- **prompt.ts**: Template for AI summarization prompts

### Content Scripts by Platform
- `contentScript_venice.ts` - Venice.ai integration
- `contentScript_claude.ts` - Claude.ai integration  
- `contentScript_chatgpt.ts` - ChatGPT integration
- `contentScript_mistral.ts` - Mistral.ai integration
- `contentScript_pageContent.ts` - General web content (excludes YouTube)
- `contentScript_youtube.ts` - YouTube-specific handling

## Technology Stack
- **Build System**: Vite with vite-plugin-web-extension
- **Language**: TypeScript  
- **Extension API**: webextension-polyfill for cross-browser compatibility
- **Content Extraction**: @mozilla/readability for web page parsing
- **Validation**: Zod for runtime type checking
- **Linting/Formatting**: Biome

## Common Commands and Timing

### Frequently Used Commands (with timing)
```bash
npm install                    # ~2-10 seconds - NEVER CANCEL
npm run build                  # ~30 seconds - NEVER CANCEL, set 60+ minute timeout  
npm run dev                    # Continuous - NEVER CANCEL, runs until stopped
npx biome check src/          # ~1-8 seconds - source files only
npx biome check --write src/  # ~1-8 seconds - auto-fix formatting
node --version                # Instant - check Node.js version
ls dist/                      # Instant - verify build output
cat dist/manifest.json | python3 -m json.tool # Instant - validate manifest JSON
```

### Build Output Verification
After `npm run build`, verify these files exist in `dist/`:
- background.js (~73KB)
- contentScript_chatgpt.js (~71KB)  
- contentScript_claude.js (~71KB)
- contentScript_mistral.js (~71KB)
- contentScript_pageContent.js (~104KB)
- contentScript_venice.js (~71KB)
- contentScript_youtube.js (~70KB)
- manifest.json (~1KB)
- icons/ directory

## Common Development Tasks

### Making Code Changes
1. Edit source files in `src/` directory
2. Run `npx biome check --write src/` to format code
3. Run `npm run build` to verify changes build successfully
4. Check that modified files are properly included in `dist/` output

### Extension Development Workflow  
1. Use `npm run dev` for development with file watching
2. Build outputs are automatically updated when source files change
3. Reload unpacked extension in browser when testing changes (if browser available)
4. Always run `npx biome check --write src/` before finalizing changes

### Debugging and Common Issues
- **Node version warnings**: Expected with Node 20.x, but builds work fine
- **Biome errors in dist/**: Normal - don't run biome on build output, only on `src/`
- **Extension manifest validation warnings**: "Cannot connect to json.schemastore.org" is expected in sandboxed environments
- **Missing browser functionality**: Extension requires browser environment for full testing

## CI/CD and Code Quality
- Always run `npx biome check --write src/` before committing
- Ensure `npm run build` succeeds before submitting changes
- Build process must complete without errors for successful deployment
- No automated test suite - rely on build validation and manual testing

## Development Dependencies
- @biomejs/biome: Code formatting and linting
- @types/webextension-polyfill: TypeScript definitions
- webextension-polyfill: Cross-browser extension API compatibility